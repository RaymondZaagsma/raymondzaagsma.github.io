<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>The Deployment Shark</title>
    <link>https://raymondzaagsma.github.io/</link>
    <description>Recent content on The Deployment Shark</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Fri, 26 Aug 2022 07:43:25 +0200</lastBuildDate><atom:link href="https://raymondzaagsma.github.io/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>AVD Azure AD SSO</title>
      <link>https://raymondzaagsma.github.io/posts/avd_aad_sso/</link>
      <pubDate>Fri, 26 Aug 2022 07:43:25 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/avd_aad_sso/</guid>
      <description>How to enable Azure Virtual Desktop Hybrid single sign-on.
login into the Azure Portal.
Go to Azure Virtual Desktop.
Open one of the created hostpools.
Select RDP Properties.
Configure : RDP will attempt to use Azure AD authentication to sign in
Go to the advanced tab.
The property that has been added is : enablerdsaadauth:i:1
Configure Azure AD Keberos
Azure AD Kerberos
# First, ensure TLS 1.2 for PowerShell gallery access.</description>
    </item>
    
    <item>
      <title>Add Steps numbers to Task Sequence</title>
      <link>https://raymondzaagsma.github.io/posts/add_steps_numbers_to_tasksequence/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/add_steps_numbers_to_tasksequence/</guid>
      <description>In order to add steps numbers to the task sequence you will have to modify the ZTIUtility.vbs file.
Make a copy of the ZTIUtility.vbs , then in the original ZTIUtility.vbs replace the code mentioned below.
Original ReportProgress Function in ZTIUtility.vbs Public Function ReportProgress(sMsg, iPercent) Dim iMaxPercent Dim oProgress Dim uStep Dim uMaxStep CreateEntry &amp;#34;Update progress [ &amp;#34; &amp;amp; iPercent &amp;amp; &amp;#34; ] : &amp;#34; &amp;amp; sMsg , LogTypeVerbose &amp;#39; Try to create the progress UI object On Error Resume Next Set oProgress = CreateObject(&amp;#34;Microsoft.</description>
    </item>
    
    <item>
      <title>Adding a delay to MDT Task Sequence</title>
      <link>https://raymondzaagsma.github.io/posts/adding_delay_to-_mdt_tasksequence/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/adding_delay_to-_mdt_tasksequence/</guid>
      <description>When receiving the error, “A connection to the deployment share (\mdt\DeploymentShare) could not be made.”
The solution is to add a delay to a task sequence.
In the deployment share , scripts folder edit the Litetouch.wsf script.
Function ValidateDeployRootWithRecovery Dim sARF Dim sNetworkErrorHint DIm iRetVal Dim sLTISuspend &amp;#39;Delay wait for DHCP wscript.sleep 5000 If oUtility.ValidateConnectionEx(oEnvironment.Item(&amp;#34;DeployRoot&amp;#34;), True) = Success then ValidateDeployRootWithRecovery = SUCCESS exit function End if </description>
    </item>
    
    <item>
      <title>Dirty Environment</title>
      <link>https://raymondzaagsma.github.io/posts/dirty_enviromnet/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/dirty_enviromnet/</guid>
      <description>Sometimes MDT deployments fail and leave the disk in a dirty (failed) state, whem you choose yes and the task sequence failes try the following solution.
Press F8 (opens a CMD window)
Unplug any USB drives or other mass storage devices - you should end up with just the internal hard drive left (CD/DVD drives don&amp;rsquo;t count here)
In the CMD window enter: DiskPart (launches the Disk Partitioning window)
In the DiskPart window enter: list disk (this will show you a list of discs available)</description>
    </item>
    
    <item>
      <title>Failure 5616</title>
      <link>https://raymondzaagsma.github.io/posts/failure_5616/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/failure_5616/</guid>
      <description>Windows 10 deployments using the Microsoft Deployment Toolkit (MDT) build 8456 fail when used with the Windows Assessment and Deployment Kit (ADK) for Windows 10 and 11. The BIOS firmware type is incorrectly identified as UEFI resulting in failures when refreshing an existing computer with a new version of Windows. When this issue occurs, the smsts.log will record the following entry: UEFI: true Errors resembling the following are then recorded at the end of the process.</description>
    </item>
    
    <item>
      <title>Install Visual C&#43;&#43; Redistributables with VcRedist</title>
      <link>https://raymondzaagsma.github.io/posts/install_visual_c&#43;&#43;_redistributables_with_vcredist/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/install_visual_c&#43;&#43;_redistributables_with_vcredist/</guid>
      <description>This powershell module can download, install or import the Visual C++ Redistributables into MDT. I use this Powershell Module to install VCRedist during the task sequence, i made a small adjustment to the script because the installation of the Powershell Module needs Nuget to work properly.
I add this powershell script as an application into MDT and add it to the task sequence.
$installedPackageProvider = Get-PackageProvider if ($installedPackageProvider.Name -notmatch &amp;#34;NuGet&amp;#34;) { Install-PackageProvider -Name NuGet -force Write-Host(&amp;#34;Install powershell module NuGet&amp;#34;) } $path = &amp;#34;C:\VcRedist&amp;#34; If(!</description>
    </item>
    
    <item>
      <title>PSADT Cheatsheet</title>
      <link>https://raymondzaagsma.github.io/posts/psadt_cheatsheet/</link>
      <pubDate>Sat, 20 Aug 2022 13:36:04 +0200</pubDate>
      
      <guid>https://raymondzaagsma.github.io/posts/psadt_cheatsheet/</guid>
      <description>These are code snippits, I frequently use in PSADT - PowerShell App Deployment Toolkit
Commonly used PSADT env variables $envCommonDesktop # C:\Users\Public\Desktop $envCommonStartMenuPrograms # C:\ProgramData\Microsoft\Windows\Start Menu\Programs $envProgramFiles # C:\Program Files $envProgramFilesX86 # C:\Program Files (x86) $envProgramData # c:\ProgramData $envUserDesktop # c:\Users\{user currently logged in}\Desktop $envUserStartMenuPrograms # c:\Users\{user currently logged in}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs $envSystemDrive # c: $envWinDir # c:\windows How to load (&amp;ldquo;dotsource&amp;rdquo;) PSADT functions/variables for manual testing (your powershell window must be run as administrator first) cd &amp;#34;$path_to_PSADT_folder_youre_working_from&amp;#34; .</description>
    </item>
    
    <item>
      <title>About</title>
      <link>https://raymondzaagsma.github.io/about/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://raymondzaagsma.github.io/about/</guid>
      <description>About Me My name is Raymond Zaagsma and I live in the city of Rotterdam, The Netherlands. I work as an Senior Consultant at Pink Elephant Netherlands.
My professional focus is on products offered by Microsoft like Enterprise Mobility, Azure Virtual Desktop, Azure Image Builder, Microsoft Deployment Toolkit and Winget.
Other product like Powershell App Deployment Toolkit for Application Packaging and Liquit will also be reviewed.</description>
    </item>
    
    <item>
      <title>Contact</title>
      <link>https://raymondzaagsma.github.io/contact/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://raymondzaagsma.github.io/contact/</guid>
      <description>Want Contact? Have questions ask me on Twitter. or ask me on Linkedin.</description>
    </item>
    
  </channel>
</rss>
